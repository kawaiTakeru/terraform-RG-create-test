trigger: none
pr: none

pool:
  name: Default

steps:
- task: PowerShell@2
  displayName: 'Slack通知テスト（pwsh対応）'
  condition: always()
  inputs:
    targetType: 'inline'
    pwsh: true
    script: |
      $webhookUrl = 'https://hooks.slack.com/services/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'
      Write-Host "DEBUG: Webhook URL = [$webhookUrl]"

      $payload = @{ text = "✅ 通知テスト from pwsh ✅" } | ConvertTo-Json
      Write-Host "DEBUG: Payload JSON = $payload"

      $response = Invoke-RestMethod `
        -Uri $webhookUrl `
        -Method POST `
        -Body $payload `
        -ContentType 'application/json' `
        -ErrorAction Stop

      Write-Host "DEBUG: Slack response = $response"
