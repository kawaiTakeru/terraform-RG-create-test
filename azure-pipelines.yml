trigger: none

pool:
  name: Default

variables:
  SLACK_WEBHOOK_URL: $(SLACK_WEBHOOK_URL)  # Azure Pipeline Library に格納

steps:
- task: PowerShell@2
  displayName: 'Slack通知テスト（変数参照）'
  inputs:
    targetType: inline
    script: |
      $webhookUrl = "${env:SLACK_WEBHOOK_URL}"
      Write-Host "DEBUG: Webhook URL = [$webhookUrl]"

      $payload = @{ text = "✅ 通知テスト 変数OK✅" } | ConvertTo-Json
      Invoke-RestMethod `
        -Uri $webhookUrl `
        -Method POST `
        -Body $payload `
        -ContentType 'application/json' `
        -ErrorAction Stop
      Write-Host "✅ Slack通知 成功"
